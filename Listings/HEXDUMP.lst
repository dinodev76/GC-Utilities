GnuCOBOL 3.0-rc1.0      HEXDUMP.cob                                                   Sun Feb 09 10:36:44 2020  Page 0001

LINE    PG/LN  A...B............................................................SEQUENCE

000001        *=========================== HEXDUMP ============================*
000002        * Authors: Brian D Pead
000003        *
000004        * Description: Subroutine to convert characters to hex.
000005        *
000006        * License: MIT
000007        *
000008        * Date        Version  Description
000009        * ----        -------  -----------
000010        * 2020-02-08  0.1      First release
000011        *================================================================*
000012
000013         IDENTIFICATION DIVISION.
000014        *========================
000015
000016         PROGRAM-ID.                 HEXDUMP.
000017
000018         ENVIRONMENT DIVISION.
000019        *=====================
000020
000021         CONFIGURATION SECTION.
000022        *----------------------
000023
000024         SOURCE-COMPUTER.
000025             IBM-Z15.
000026        *    IBM-Z15 DEBUGGING MODE.
000027
000028         INPUT-OUTPUT SECTION.
000029        *---------------------
000030
000031         FILE-CONTROL.
GnuCOBOL 3.0-rc1.0      HEXDUMP.cob                                                   Sun Feb 09 10:36:44 2020  Page 0002

LINE    PG/LN  A...B............................................................SEQUENCE

000032        /
000033         DATA DIVISION.
000034        *==============
000035
000036         FILE SECTION.
000037        *-------------
000038
000039         WORKING-STORAGE SECTION.
000040        *------------------------
000041
000042         01  FILLER                  PIC X(01)       VALUE 'Y'.
000043             88  W-FIRST-CALL                        VALUE 'Y'.
000044             88  W-NOT-FIRST-CALL                    VALUE 'N'.
000045
000046         01  W-COMPILED-DATE.
000047             05  W-COMPILED-DATE-YYYY
000048                                     PIC X(04).
000049             05  W-COMPILED-DATE-MM  PIC X(02).
000050             05  W-COMPILED-DATE-DD  PIC X(02).
000051             05  W-COMPILED-TIME-HH  PIC X(02).
000052             05  W-COMPILED-TIME-MM  PIC X(02).
000053             05  W-COMPILED-TIME-SS  PIC X(02).
000054             05  FILLER              PIC X(07).
000055
000056         01  W-SUB                   PIC S9(04)      COMP.
000057         01  FILLER REDEFINES W-SUB.
000058             05  FILLER              PIC X(01)       VALUE X'00'.
000059             05  W-SUB-2             PIC X(01).
000060
000061         COPY HEXDUMPW.
000001C       *================================================================*
000002C       *         Table generated by C# program CobolBitwiseGen          *
000003C       *                                                                *
000004C       *         Author: Brian D Pead                                   *
000005C       *                                                                *
000006C       *         License: MIT                                           *
000007C       *                                                                *
000008C       *         Date: 2020-02-08                                       *
000009C       *================================================================*
000010C
000011C        01  W-HEXDUMP-TABLE.
000012C            05  FILLER-000          PIC X(128)      VALUE
000013C                                        '000102030405060708090A0B0C0D0E0F
000014C       -                                '101112131415161718191A1B1C1D1E1F
000015C       -                                '202122232425262728292A2B2C2D2E2F
000016C       -                                '303132333435363738393A3B3C3D3E3F
000017C       -                                ''.
000018C            05  FILLER-064          PIC X(128)      VALUE
000019C                                        '404142434445464748494A4B4C4D4E4F
000020C       -                                '505152535455565758595A5B5C5D5E5F
000021C       -                                '606162636465666768696A6B6C6D6E6F
000022C       -                                '707172737475767778797A7B7C7D7E7F
GnuCOBOL 3.0-rc1.0      HEXDUMP.cob                                                   Sun Feb 09 10:36:44 2020  Page 0003

LINE    PG/LN  A...B............................................................SEQUENCE

000023C       -                                ''.
000024C            05  FILLER-128          PIC X(128)      VALUE
000025C                                        '808182838485868788898A8B8C8D8E8F
000026C       -                                '909192939495969798999A9B9C9D9E9F
000027C       -                                'A0A1A2A3A4A5A6A7A8A9AAABACADAEAF
000028C       -                                'B0B1B2B3B4B5B6B7B8B9BABBBCBDBEBF
000029C       -                                ''.
000030C            05  FILLER-192          PIC X(128)      VALUE
000031C                                        'C0C1C2C3C4C5C6C7C8C9CACBCCCDCECF
000032C       -                                'D0D1D2D3D4D5D6D7D8D9DADBDCDDDEDF
000033C       -                                'E0E1E2E3E4E5E6E7E8E9EAEBECEDEEEF
000034C       -                                'F0F1F2F3F4F5F6F7F8F9FAFBFCFDFEFF
000035C       -                                ''.
000036C        01  FILLER REDEFINES W-HEXDUMP-TABLE.
000037C            05  W-HEX-CHARS         PIC X(02)       OCCURS 256.
GnuCOBOL 3.0-rc1.0      HEXDUMP.cob                                                   Sun Feb 09 10:36:44 2020  Page 0004

LINE    PG/LN  A...B............................................................SEQUENCE

000062        /
000063         LINKAGE SECTION.
000064        *----------------
000065
000066         01  L-PARAMETER.            COPY HEXDUMPL.
000001C       *========================= HEXDUMPL.cpy =========================*
000002C       * Authors: Brian D Pead
000003C       *
000004C       * Description: Linkage parameter for subroutine HEXDUMP which
000005C       *              convert input buffer to hex output.
000006C       *
000007C       * License: MIT
000008C       *
000009C       * Date        Version  Description
000010C       * ----        -------  -----------
000011C       * 2020-02-08  1.0      First release
000012C       *================================================================*
000013C
000014C       *01  HEXDUMP-PARAMETER.
000015C
000016C       **** Input fields:
000017C       ****     HD-INPUT-PTR:
000018C       ****         Pointer to input.
000019C       ****     HD-INPUT-LEN:
000020C       ****         Length of input.
000021C       ****     HD-OUTPUT-PTR:
000022C       ****         Pointer to output (area must be twice the length of
000023C       ****         the input).
000024C
000025C       **** Output field:
000026C       ****     The area pointed to by HD-OUTPUT-PTR.
000027C
000028C            05  HD-INPUT-PTR                        POINTER.
000029C
000030C            05  HD-INPUT-LEN        PIC 9(09)  COMP.
000031C
000032C            05  HD-OUTPUT-PTR                       POINTER.
000067
000068         01  L-INPUT-BUFFER.
000069             05  L-INPUT-CHAR        PIC X(01)       OCCURS 32768
000070                                                     INDEXED L-I-DX.
000071
000072         01  L-OUTPUT-BUFFER.
000073             05  L-OUTPUT-HEX        PIC X(02)       OCCURS 32768
000074                                                     INDEXED L-O-DX.
GnuCOBOL 3.0-rc1.0      HEXDUMP.cob                                                   Sun Feb 09 10:36:44 2020  Page 0005

LINE    PG/LN  A...B............................................................SEQUENCE

000075        /
000076         PROCEDURE DIVISION USING L-PARAMETER.
000077        *==================
000078
000079         MAIN.
000080        *-----
000081
000082             PERFORM SUB-1000-START-UP THRU SUB-1000-EXIT
000083
000084             PERFORM SUB-2000-PROCESS THRU SUB-2000-EXIT
000085                 VARYING L-I-DX FROM 1 BY 1
000086                   UNTIL L-I-DX > HD-INPUT-LEN
000087             .
000088         MAIN-EXIT.
000089             GOBACK.
GnuCOBOL 3.0-rc1.0      HEXDUMP.cob                                                   Sun Feb 09 10:36:44 2020  Page 0006

LINE    PG/LN  A...B............................................................SEQUENCE

000090        /
000091         SUB-1000-START-UP.
000092        *------------------
000093
000094             SET  ADDRESS OF L-INPUT-BUFFER
000095                                     TO HD-INPUT-PTR
000096             SET  ADDRESS OF L-OUTPUT-BUFFER
000097                                     TO HD-OUTPUT-PTR
000098
000099             IF      W-NOT-FIRST-CALL
000100                 GO TO SUB-1000-EXIT
000101             END-IF
000102
000103             SET W-NOT-FIRST-CALL    TO TRUE
000104             MOVE FUNCTION WHEN-COMPILED
000105                                     TO W-COMPILED-DATE
000106
000107             DISPLAY 'HEXDUMP  compiled on '
000108                 W-COMPILED-DATE-YYYY '/'
000109                 W-COMPILED-DATE-MM   '/'
000110                 W-COMPILED-DATE-DD   ' at '
000111                 W-COMPILED-TIME-HH   ':'
000112                 W-COMPILED-TIME-MM   ':'
000113                 W-COMPILED-TIME-SS
000114             .
000115         SUB-1000-EXIT.
000116             EXIT.
GnuCOBOL 3.0-rc1.0      HEXDUMP.cob                                                   Sun Feb 09 10:36:44 2020  Page 0007

LINE    PG/LN  A...B............................................................SEQUENCE

000117        /
000118         SUB-2000-PROCESS.
000119        *-----------------
000120
000121             MOVE L-INPUT-CHAR(L-I-DX)
000122                                     TO W-SUB-2
000123             SET  L-O-DX             TO L-I-DX
000124             MOVE W-HEX-CHARS(W-SUB + 1)
000125                                     TO L-OUTPUT-HEX(L-O-DX)
000126             .
000127         SUB-2000-EXIT.
000128             EXIT.
GnuCOBOL 3.0-rc1.0      HEXDUMP.cob                                                   Sun Feb 09 10:36:44 2020  Page 0008

SIZE  TYPE           LVL  NAME                           PICTURE

      WORKING-STORAGE SECTION

00001 ALPHANUMERIC   01   FILLER                         X(01)
      CONDITIONAL    88   W-FIRST-CALL
      CONDITIONAL    88   W-NOT-FIRST-CALL

00021 GROUP          01   W-COMPILED-DATE
00004 ALPHANUMERIC   05   W-COMPILED-DATE-YYYY           X(04)
00002 ALPHANUMERIC   05   W-COMPILED-DATE-MM             X(02)
00002 ALPHANUMERIC   05   W-COMPILED-DATE-DD             X(02)
00002 ALPHANUMERIC   05   W-COMPILED-TIME-HH             X(02)
00002 ALPHANUMERIC   05   W-COMPILED-TIME-MM             X(02)
00002 ALPHANUMERIC   05   W-COMPILED-TIME-SS             X(02)
00007 ALPHANUMERIC   05   FILLER                         X(07)

00002 NUMERIC        01   W-SUB                          S9(04) COMP

00002 GROUP          01   FILLER, REDEFINES W-SUB
00001 ALPHANUMERIC   05   FILLER                         X(01)
00001 ALPHANUMERIC   05   W-SUB-2                        X(01)

00512 GROUP          01   W-HEXDUMP-TABLE
00128 ALPHANUMERIC   05   FILLER                         X(128)
00128 ALPHANUMERIC   05   FILLER                         X(128)
00128 ALPHANUMERIC   05   FILLER                         X(128)
00128 ALPHANUMERIC   05   FILLER                         X(128)

00512 GROUP          01   FILLER, REDEFINES W-HEXDUMP-TABLE
00002 ALPHANUMERIC   05   W-HEX-CHARS                    X(02), OCCURS 256

      LINKAGE SECTION

00020 GROUP          01   L-PARAMETER
00008 POINTER        05   HD-INPUT-PTR
00004 NUMERIC        05   HD-INPUT-LEN                   9(09) COMP
00008 POINTER        05   HD-OUTPUT-PTR

32768 GROUP          01   L-INPUT-BUFFER
00001 ALPHANUMERIC   05   L-INPUT-CHAR                   X(01), OCCURS 32768

65536 GROUP          01   L-OUTPUT-BUFFER
00002 ALPHANUMERIC   05   L-OUTPUT-HEX                   X(02), OCCURS 32768


0 warnings in compilation group
0 errors in compilation group
